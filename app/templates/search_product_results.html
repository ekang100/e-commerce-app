{% extends "base.html" %}

{% block content %}

<br><br>

<h2>Product Results:</h2>
<table class='table table-hover table-bordered container'>
  <thead class="thead-dark">
    <tr>
      <th scope="col">Product Image</th>
      <th scope="col">Product Name</th>
      <th scope="col">Price</th>
      <th scope="col">Product Details</th>
    </tr>
  </thead>
  <tbody>
    {% if products %}
      {% for product in products %}
        <tr>
          <!--<th scope="row">{{product.productid}}</th>-->
          <td><img src="/static/{{ product.productid }}.png" alt="{{product.name}}" width="100" height="100"></td>
          <td>{{product.name}}</td>
          <td>{{product.price}}</td>
          <td><a href="/product/{{ product.productid }}">View Details</a></td>
        </tr>
      {% endfor %}
    {% else %}
        <p>No products found</p>
    {% endif %}
  </tbody>
</table>

<div class="pagination">
  <ul class="pagination-list">
    {% set total_pages = (total // per_page) + (1 if total % per_page > 0 else 0) %}
    
    {# Determine start and end pages to display #}
    {% set start_page = page - 2 if page > 2 else 1 %}
    {% set end_page = start_page + 4 if start_page + 4 <= total_pages else total_pages %}
    
    {# Previous Button #}
    {% if page > 1 %}
      <li class="page-item">
        <a href="{{ url_for('products.search_keywords', query=query, page=page-1) }}">Previous</a>
      </li>
    {% endif %}
    
    {# Display page numbers within range #}
    {% for p in range(start_page, end_page + 1) %}
      <li class="page-item {% if p == page %}active{% endif %}">
        <a href="{{ url_for('products.search_keywords', query=query, page=p) }}">{{ p }}</a>
      </li>
    {% endfor %}
    
    {# Next Button #}
    {% if page <= total_pages %}
      <li class="page-item">
        <a href="{{ url_for('products.search_keywords', query=query, page=page+1) }}">Next</a>
      </li>
    {% endif %}
  </ul>
</div>



{% endblock %}
