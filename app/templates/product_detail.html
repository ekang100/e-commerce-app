{% extends "base.html" %}

{% block content %}

<!--<h2>Products Details:</h2>

<table class='table table-hover table-bordered container'>
  <thead class="thead-dark">
    <tr>
      <th scope="col">Product Image</th>
      <th scope="col">Product Name</th>
      <th scope="col">Description</th>
      <th scope="col">Price</th>
    </tr>
  </thead>
  <tbody>
    {% if product %}
      <tr>
        <th scope="row">{{product.productid}}</th>
        <td><img src="/static/{{ product.productid }}.png" alt="{{product.name}}" width="100" height="100"></td>
        <td>{{product.name}}</td>
        <td>{{product.price}}</td>
      </tr>
      {% else %}
      <p>Product not found</p>
    {% endif %}
  </tbody>
</table>
<a href="/">Back to Product List</a>-->

<div class="product">
  {% if product %}
  <h2>{{product.name}}</h2>
  
    <div class="product-info">
        <img src="/static/{{ product.productid }}.png" alt="{{product.name}}">
        <h3>Product Description</h3>
        <p>{{product.description}}</p>
        <h3>Price</h3>
        <p>${{product.price}}</p>
    </div>

    {% if product.available %}
      <div class="container">
        <h2>Available Sellers</h2>
        <table class='table table-hover table-bordered container'>
            <thead class="thead-dark">
            <tr>
                <th scope="col">Seller</th>
                <th scope="col">Price</th>
                <th scope="col">Available quantity</th>
                <th scope="col">Actions</th>
            </tr>
            </thead>
            <tbody>
            {% for i in inventory %}
                <tr>
                    <th scope="row"><form style="margin-top: 10px;" action="{{ url_for('users.public_profile', account_id=i.sid) }}" method="post">
                      <button type="submit">
                          {{ i.seller_firstname }}
                      </button>
                  </form></th>
                    
                    <th scope="row">{{ i.price }}</th>
                    <td>{{ i.quantity }}</td>
                    <td>
                        {% if current_user.is_authenticated %}
                            <form action="{{ url_for('cart.cart') }}" method="post">
                                <input type="hidden" name="action" value="add"/>
                                <input type="hidden" name="seller_id" value="{{ i.sid }}"/>
                                <input type="hidden" name="product_id" value="{{ product.productid }}"/>
                                <input type="hidden" name="price" value="{{ i.price }}"/>
                                <label for="qty">Quantity:</label>
                                <input type="number" id="qty" name="qty" min="1" max="{{ i.quantity }}" value="1">
                                <input type="submit" value="Add to Cart">
                            </form>
                            {% else %}
                              <p><a href="{{ url_for('users.login') }}">Log in</a> to add items to your cart</p>
                          {% endif %}
                      </td>

                </tr>
              {% endfor %}
            </tbody>
        </table>
      </div>
    {% else %}
    <h3>Product is out of stock. Check back soon!</h3>
    {% endif %}

    <div class="container">
      <h2>Reviews</h2>
      <table class='table table-hover table-bordered container'>
          <thead class="thead-dark">
          <tr>
              <th scope="col">Reviewer</th>
              <th scope="col">Rating</th>
              <th scope="col">Comments</th>
          </tr>
          </thead>
          <tbody>
          {% for r in reviews %}
              <tr>
                  <th scope="row"><form style="margin-top: 10px;" action="{{ url_for('users.public_profile', account_id=r.reviewer_id) }}" method="post">
                    <button type="submit">
                        {{ r.reviewer_firstname }}
                    </button>
                </form></th>
                  
                  <th scope="row">{{ r.rating }}</th>
                  <td>{{ r.comment }}</td>

              </tr>
            {% endfor %}
          </tbody>
      </table>
        
      {% if current_user.is_authenticated %}
        <form action="{{ url_for('feedback.post_review_route') }}" method="post">
            <input type="hidden" name="action" value="add"/>
            <input type="hidden" name="user_id" value="{{ current_user.id }}"/>
            <input type="hidden" name="product_id" value="{{ product.productid }}"/>
            idk what other info you need
            <input type="submit" value="Add Review">
        </form>
      {% else %}
        <p><a href="{{ url_for('users.login') }}">Log in</a> to add items to add reviews</p>
      {% endif %}
    </div>
  
    {% endif %}

{% endblock %}app/templates/product_detail.html