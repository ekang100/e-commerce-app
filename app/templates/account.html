{% if current_user.is_authenticated %}
{% extends "base.html" %}

{% block content %}

<h1> <span style = "color:#FFD700"> {{current_user.firstname}}'s Cosmic Dashboard</span></h1>

<table class='table table-bordered container'>
  <thead class="thead-dark">
      <tr>
          <th scope="col">Galactic Info</th>
      </tr>
  </thead>
  <tbody>
      <tr>
        <td>
          <strong style="color: #FFD700">Account ID:</strong> <span style="color: #eee">{{current_user.id}}</span>
          
        </td>
      </tr>
      <tr>
          <td>
            <strong style="color: #FFD700">Balance:</strong> <span style="color: #eee">{{current_user.balance}}</span>
            <a href="{{ url_for('users.add_balance') }}" class="btn btn-primary" style="margin-top: 10px; border: 2px solid #FFD700; float:right; color: #FFD700;"
              role="'button">Add Balance</a>
          </td>
      </tr>
      <tr>
          <td>
            <strong style="color: #FFD700">Email:</strong> <span style="color: #eee">{{current_user.email}}</span>
              <!-- <button href='\'class="btn btn-primary" style="float: right; background-color: #00aaff;">Update</button> -->
          </td>
      </tr>
      <tr>
          <td>
            <strong style="color: #FFD700">Name:</strong> <span style="color: #eee">{{current_user.firstname}} {{current_user.lastname}}</span>
                          <!-- <button class="btn btn-primary" style="float: right; background-color: #00aaff;">Update</button> -->
          </td>
      </tr>
      <tr>
          <td>
            <strong style="color: #FFD700">Address:</strong> <span style="color: #eee">{{current_user.address}}</span>

              <!-- <button class="btn btn-primary" style="float: right; background-color: #00aaff;">Update</button> -->
          </td>
      </tr>
      <tr>
        <td>
          <strong style="color: #FFD700">Seller Status:</strong> <span style="color: #eee">{{current_user.isSeller}}</span>
              {% if not current_user.isSeller %}
            <form method="POST" action="{{ url_for('users.become_seller') }}">
                <button type="submit" class="btn btn-primary" style="margin-top: 10px; border: 2px solid #FFD700; float:right; color: #FFD700;" role="button">Become a Seller</button>
            </form>            
            {% endif %}       
        </td>
      </tr>
      <tr>
        <td>
          <strong style="color: #FFD700">Verified Status:</strong> <span style="color: #eee">{{current_user.isVerified}}</span>
            {% if not current_user.isVerified %}
            <form method="POST" action="{{ url_for('users.verify_account') }}">
                <button type="submit" class="btn btn-primary" style="margin-top: 10px; border: 2px solid #FFD700; float:right; color: #FFD700;" role="button">Become Verfied User</button>
            </form>            
            {% endif %}
            {% if current_user.isVerified %}
              <i class="fas fa-star" style="color: yellow; font-size: 16px; float: right;"></i>
              <i class="fas fa-star" style="color: yellow; font-size: 16px; float: right;"></i>
              <i class="fas fa-star" style="color: yellow; font-size: 16px; float: right;"></i>
            {% endif %}</th>       
        </td>
      </tr>
  </tbody>
</table>

<p style="color: #FFD700; margin-top: 10px;">
    ***<strong>Disclaimer:</strong> Star verification status requires BoxML approval and a one-time fee of $500***
</p>

<a href="{{ url_for('users.update_name_address') }}" class="btn btn-primary" style="margin-top: 10px; margin-right: 10px; border: 2px solid #FFD700; float:left; color: #FFD700;" role="'button">Update Name/Address</a>
<a href="{{ url_for('users.change_email') }}" class="btn btn-primary" style="margin-top: 10px; margin-right: 10px; border: 2px solid #FFD700; float:left; color: #FFD700;" role="'button">Change Email</a>
<a href="{{ url_for('users.change_password') }}" class="btn btn-primary" href="cart" style="margin-top: 10px; border: 2px solid #FFD700; float:left; color: #FFD700;" role="button">Change Star Password</a>

<br><br>
<hr style="border: none; border-top: 2px solid black; clear: both; margin-top: 70px;">
<h1 style = "color: #FFD700;">{{current_user.firstname}}'s Recent Purchases:</h1>
<table class='table table-hover table-bordered container'>
  <thead class="thead-dark">
    <tr>
      <th scope="col">Product Name</th>
      <th scope="col">Number of Items</th>
      <th scope="col">Total Price</th>
      <th scope="col">Date Purchased</th>
      <th scope="col">Order Fulfilled</th>
    </tr>
  </thead>
  <tbody>
    {% for purchase in purchase_history%}
      <tr>
        <th scope="row">{{purchase.name}}</th>
        <td>{{purchase.quantities}}</td>
        <td>{{ purchase.quantities * purchase.price }}</td>
        <td>{{purchase.time_purchased}}</td>
        <td>{{purchase.fulfilledStatus}}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>

{% if current_user.isSeller %}
<hr style="border: none; border-top: 2px solid black; clear: both; margin-top: 70px;">
<div class="d-flex justify-content-between">
  <h1 style="font-size: 1.5em;"><span style="color: #FFD700;">{{current_user.firstname}}'s Seller Profile</span></h1>

  <!-- Products for Sale Button -->
<a href="{{ url_for('sellers.get_seller_inventory', seller_id=current_user.id) }}" class="btn btn-info" style="border: 1px solid #FFD700; color: #FFD700; font-size: 0.9em;">
  Products for Sale
</a>

<!-- Fulfilled Orders Button -->
<a href="{{ url_for('sellers.get_fulfilled_order_history', seller_id=current_user.id) }}" class="btn btn-success" style="border: 1px solid #FFD700; color: #FFD700; font-size: 0.9em;">
  Fulfilled Orders History
</a>

<!-- Unfulfilled Orders Button -->
<a href="{{ url_for('sellers.get_unfulfilled_order_history', seller_id=current_user.id) }}" class="btn btn-danger" style="border: 1px solid #FFD700; color: #FFD700; font-size: 0.9em;">
  Unfulfilled Orders History 
</a>




</div>





<hr style="border: none; border-top: 2px solid black; clear: both; margin-top: 70px;">
<h1><span style="color: #FFD700;">{{ current_user.firstname }}'s Seller Reviews</span></h1>

<table class='table table-hover table-bordered container'>
  <thead class="thead-dark">
    <tr>
      <th scope="col">Type</th>
      <th scope="col">Entity Name</th>
      <th scope="col">User ID</th>
      <th scope="col">Rating</th>
      <th scope="col">Comments</th>
      <th scope="col">Date</th>
    </tr>
  </thead>
  <tbody>
    {% for feedback in feedbacks %}
      <tr>
        <td>{{ feedback.type }}</td>
        <td>{{ feedback.entity_name }}</td>
        <td>{{ feedback.uid }}</td>
        <td>{{ feedback.rating }}</td>
        <td>{{ feedback.comments }}</td>
        <td>{{ feedback.date }}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>

{% endif %}
{% endblock %}
{% endif %}
